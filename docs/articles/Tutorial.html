<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gwasglue2">
<title>Tutorial • gwasglue2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="gwasglue2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gwasglue2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Strategy.html">Strategy</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">Tutorial</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MRCIEU/gwasglue2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MRCIEU/gwasglue2/blob/HEAD/vignettes/Tutorial.Rmd" class="external-link"><code>vignettes/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/gwasglue2" class="external-link">gwasglue2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TwoSampleMR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/ieugwasr" class="external-link">ieugwasr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hyprcoloc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephenslab/susieR" class="external-link">susieR</a></span><span class="op">)</span></span></code></pre></div>
<p>There are two usecases for this tutorial</p>
<ol style="list-style-type: decimal">
<li>Performing a basic TwoSampleMR analysis</li>
<li>Generating a regional genotype-phenotype map (Million Veteran’s Programme analysis example)</li>
</ol>
<div class="section level4">
<h4 id="this-tutorial-is-still-work-in-progress--it-reflects-an-earlier-draft-of-gwasglue2-">This tutorial is still work in progress. It reflects an earlier draft of gwasglue2.<a class="anchor" aria-label="anchor" href="#this-tutorial-is-still-work-in-progress--it-reflects-an-earlier-draft-of-gwasglue2-"></a>
</h4>
</div>
<div class="section level2">
<h2 id="twosamplemr-analysis">1. TwoSampleMR analysis<a class="anchor" aria-label="anchor" href="#twosamplemr-analysis"></a>
</h2>
<p>We will perform an MR analysis of body mass index (exposure - ieu-a-2) against coronary heart disease (outcome - ieu-a-7).</p>
<p>Obtain the data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clumpTophits.html">clumpTophits</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="st">"ieu-a-2"</span><span class="op">)</span></span>
<span><span class="va">sumset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SummarySet.html">SummarySet</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="st">"ieu-a-2"</span>, variants <span class="op">=</span> <span class="va">x</span>, tools <span class="op">=</span> <span class="st">"mr"</span><span class="op">)</span></span>
<span><span class="va">sumset1</span></span>
<span><span class="va">sumset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SummarySet.html">SummarySet</a></span><span class="op">(</span>traits<span class="op">=</span><span class="st">"ieu-a-7"</span>, variants<span class="op">=</span><span class="va">x</span>,tools <span class="op">=</span><span class="st">"mr"</span><span class="op">)</span></span>
<span><span class="va">sumset2</span></span></code></pre></div>
<p>Set the Metadata and MR labels for each of your summary sets</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumset1</span> <span class="op">&lt;-</span> <span class="fu">setMetadata</span><span class="op">(</span><span class="va">sumset1</span>, source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>, traits <span class="op">=</span> <span class="st">"ieu-a-2"</span><span class="op">)</span></span>
<span><span class="va">sumset1</span> <span class="op">&lt;-</span><span class="fu">setMRlabel</span><span class="op">(</span><span class="va">sumset1</span>, mr_label <span class="op">=</span> <span class="st">"exposure"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sumset2</span> <span class="op">&lt;-</span> <span class="fu">setMetadata</span><span class="op">(</span><span class="va">sumset2</span>,source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>, traits <span class="op">=</span> <span class="st">"ieu-a-7"</span><span class="op">)</span></span>
<span><span class="va">sumset2</span> <span class="op">&lt;-</span><span class="fu">setMRlabel</span><span class="op">(</span><span class="va">sumset2</span>, mr_label <span class="op">=</span> <span class="st">"outcome"</span><span class="op">)</span></span></code></pre></div>
<p>Check the Metadata and MR labels</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">getMetadata</span><span class="op">(</span><span class="va">sumset1</span><span class="op">)</span></span>
<span><span class="fu">getMRlabel</span><span class="op">(</span><span class="va">sumset1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getMetadata</span><span class="op">(</span><span class="va">sumset2</span><span class="op">)</span></span>
<span><span class="fu">getMRlabel</span><span class="op">(</span><span class="va">sumset2</span><span class="op">)</span></span></code></pre></div>
<p>Create the DataSet object</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">(</span><span class="va">sumset1</span>,<span class="va">sumset2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">overlapSNP</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/harmoniseData.html">harmoniseData</a></span><span class="op">(</span><span class="va">.</span>,tolerance <span class="op">=</span> <span class="fl">0.08</span>,action <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Convert dataset to TwoSampleMR format</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_mr</span> <span class="op">&lt;-</span> <span class="fu">convertForTwoSampleMR</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></code></pre></div>
<p>Perform the MR analysis</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_result</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dataset_mr</span><span class="op">@</span><span class="va">summary_sets</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">ss</span>,<span class="va">dataset_mr</span><span class="op">@</span><span class="va">summary_sets</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">ss</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"mr_keep"</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">TwoSampleMR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TwoSampleMR/man/mr.html" class="external-link">mr</a></span><span class="op">(</span><span class="va">.</span>, method_list<span class="op">=</span><span class="st">"mr_ivw"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mr_result</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regional-genotype-phenotype-map-wip">2. Regional genotype-phenotype map (WIP)<a class="anchor" aria-label="anchor" href="#regional-genotype-phenotype-map-wip"></a>
</h2>
<p>We need to first define a genomic range for the analysis to be performed. This is a known LD block on chromosome 22 (build hg19)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genomicrange</span> <span class="op">&lt;-</span> <span class="st">"22:43714200-44995307"</span></span></code></pre></div>
<p>We need to scan OpenGWAS for traits that have a significant associations in this region</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id_list</span> <span class="op">&lt;-</span> <span class="fu">ieugwasr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ieugwasr/man/phewas.html" class="external-link">phewas</a></span><span class="op">(</span>pval <span class="op">=</span> <span class="fl">5e-6</span>, variants<span class="op">=</span><span class="va">genomicrange</span>, batch<span class="op">=</span><span class="st">"ukb-a"</span><span class="op">)</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Obtain data</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">gwasglue2</span><span class="fu">::</span><span class="fu">create_dataset</span><span class="op">(</span>traits<span class="op">=</span><span class="va">id_list</span>, variants<span class="op">=</span><span class="va">genomicrange</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gwasglue2</span><span class="fu">::</span><span class="fu">annotate</span><span class="op">(</span>ld_matrix<span class="op">=</span><span class="st">"1000genomes_EUR"</span><span class="op">)</span></span></code></pre></div>
<p>Next, for each trait we need to perform finemapping. This will involve using SusieR to identify credible sets in the region for the trait, and then generate the conditional summary datasets for each credible set. Explanation:</p>
<p>Credible set: If a trait is inferred to have e.g. 3 causal variants in the genomic region then there will be 3 credible sets. Each credible set is essentially a cluster of SNPs close by, it will include 1 or more SNPs that are candidates to be the causal variant.</p>
<p>Conditional summary datasets: Once credible sets are identified, we can try to estimate what the summary data results would have looked like for each credible set after accounting for all the other credible sets. So in this example there would be 3 conditional summary datasets, each with a single peak in a different location.</p>
<p>Use susieR to generate the credible sets for each dataset (e.g. some of them will have only 1, some will have more than 1. But all of them will have at least 1 because they have been selected to have an association in the region)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">gwasglue2</span><span class="fu">::</span><span class="fu">annotate</span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">.</span>, credible_sets<span class="op">=</span><span class="st">"susieR"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can perform the colocalisation. Here we want to jointly colocalise across all the conditional summary datasets</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">hyprcoloc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hyprcoloc/man/hyprcoloc.html" class="external-link">hyprcoloc</a></span><span class="op">(</span>dataset<span class="op">=</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="alternative-coloc-example-wip">Alternative coloc example (WIP)<a class="anchor" aria-label="anchor" href="#alternative-coloc-example-wip"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/gwasglue2" class="external-link">gwasglue2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'ritarasteiro/hyprcoloc'</span>, build_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'--resave-data'</span>, <span class="st">'--no-manual'</span><span class="op">)</span>, build_vignettes <span class="op">=</span> <span class="cn">FALSE</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'ritarasteiro/susieR'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephenslab/susieR" class="external-link">susieR</a></span><span class="op">)</span>     <span class="co"># fork that takes Summaryset</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hyprcoloc</span><span class="op">)</span>  <span class="co"># fork that takes Dataset</span></span></code></pre></div>
<p>We’ll analyse the following IDs (chd - cardiac heart disease; ldl - low-density lipoprotein; hdl - high-density lipoprotein; trig - triglycerides and t2d - type 2 diabetes) around the HMGCR (3-hydroxy-3-methylglutaryl-CoA reductase) gene region.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chd_id</span> <span class="op">&lt;-</span> <span class="st">"ieu-a-7"</span></span>
<span><span class="va">ldl_id</span> <span class="op">&lt;-</span> <span class="st">"ieu-b-110"</span></span>
<span><span class="va">hdl_id</span> <span class="op">&lt;-</span> <span class="st">"ieu-b-109"</span></span>
<span><span class="va">trig_id</span> <span class="op">&lt;-</span> <span class="st">"ieu-b-111"</span></span>
<span><span class="va">t2d_id</span> <span class="op">&lt;-</span> <span class="st">"ebi-a-GCST006867"</span></span>
<span><span class="va">hmgcr_chrpos</span> <span class="op">&lt;-</span> <span class="st">"5:74132993-75132993"</span></span></code></pre></div>
<p>Create summarysets</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">chd_id</span>, <span class="va">ldl_id</span>, <span class="va">hdl_id</span>, <span class="va">trig_id</span>, <span class="va">t2d_id</span><span class="op">)</span></span>
<span><span class="co"># create s4 SummarySet objects (named sumset1...n) and fill metadata slot using the createSummarySets() in ieugwas_utils</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">createSummarySets</span><span class="op">(</span>traits<span class="op">=</span><span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                          variants <span class="op">=</span> <span class="st">"5:74132993-75132993"</span>,</span>
<span>                          tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"finemap"</span>,<span class="st">"coloc"</span><span class="op">)</span>,</span>
<span>                          source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>,</span>
<span>                          ld_ref <span class="op">=</span> <span class="st">"/project/data/reference/ld/EUR"</span><span class="op">)</span>                        </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sumset"</span>,<span class="va">i</span><span class="op">)</span> , <span class="va">s</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Create dataset and harmonise trait against trait, trait against LD matrix</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create S4 DataSet object (hmgcr)</span></span>
<span><span class="va">ds_hmgcr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">(</span><span class="va">sumset1</span>,<span class="va">sumset2</span>,<span class="va">sumset3</span>,<span class="va">sumset4</span>,<span class="va">sumset5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">overlapSNP</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/harmoniseData.html">harmoniseData</a></span><span class="op">(</span><span class="va">.</span>,tolerance <span class="op">=</span> <span class="fl">0.08</span>,action <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">buildLDMatrix</span><span class="op">(</span><span class="va">.</span>, bfile <span class="op">=</span> <span class="cn">TRUE</span>, plink_bin <span class="op">=</span> <span class="st">"plink"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">harmoniseLDMatrix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> </span></code></pre></div>
<p>After summary sets are harmonised, marginalise each summary set independently and create a new dataset with all marginalised summary sets merged</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># do finemapping with susie</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>ntraits &lt;-<span class="st"> </span><span class="kw">getLength</span>(ds_hmgcr)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>ds_hmgcr_marginalised &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>ntraits, <span class="cf">function</span>(trait)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>  {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>    <span class="co"># Takes in 1 SS</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>    <span class="co"># Outputs 1 DS (with at least 1 SS)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>    ds &lt;-<span class="st"> </span><span class="kw">susie_rss</span>(<span class="dt">R =</span> <span class="kw">getLDMatrix</span>(ds_hmgcr,trait), <span class="dt">summaryset =</span> <span class="kw">getSummarySet</span>(ds_hmgcr, trait))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>}) </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>a<span class="dv">-7</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>b<span class="dv">-111</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ebi<span class="op">-</span>a<span class="op">-</span>GCST006867), with the parameter values used. The summary statistics beta and se will not be marginalised.</span></code></pre></div>
<p>Because not all datasets were marginalised, we are going to merge just the ones that were</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_hmgcr_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_datasets.html">merge_datasets</a></span><span class="op">(</span><span class="va">ds_hmgcr_marginalised</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">ds_hmgcr_marginalised</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Try hyprcoloc with raw datasets. (Use fork of hypercoloc that allows a dataset object to be provided)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>res_hmgcr &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span> ds_hmgcr)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="kw">print</span>(res_hmgcr)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>  iteration                      traits posterior_prob regional_prob</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span>          ieu<span class="op">-</span>a<span class="dv">-7</span>, ieu<span class="op">-</span>b<span class="dv">-110</span>         <span class="fl">0.5940</span>        <span class="fl">0.6052</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span> ieu<span class="op">-</span>b<span class="dv">-109</span>, ebi<span class="op">-</span>a<span class="op">-</span>GCST006867         <span class="fl">0.9934</span>        <span class="fl">0.9997</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>  candidate_snp posterior_explained_by_snp dropped_trait</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a><span class="dv">1</span>       rs12916                     <span class="fl">0.9996</span>            <span class="ot">NA</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a><span class="dv">2</span>     rs2307111                     <span class="fl">0.9932</span>            <span class="ot">NA</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc"</span></span></code></pre></div>
<p>Try hyprcoloc with marginalised datasets</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>res_hmgcr_marginalised &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span> ds_hmgcr_marginalised)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a><span class="kw">print</span>(res_hmgcr_marginalised)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>  iteration                     traits posterior_prob regional_prob</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span> ieu<span class="op">-</span>b<span class="dv">-110</span>_L2, ieu<span class="op">-</span>b<span class="dv">-110</span>_L3         <span class="fl">0.7226</span>        <span class="fl">1.0000</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span> ieu<span class="op">-</span>b<span class="dv">-110</span>_L1, ieu<span class="op">-</span>b<span class="dv">-110</span>_L4         <span class="fl">0.3766</span>        <span class="fl">0.5999</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>  candidate_snp posterior_explained_by_snp dropped_trait</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a><span class="dv">1</span>    rs59992948                     <span class="fl">0.0106</span>            <span class="ot">NA</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a><span class="dv">2</span>    rs16872674                     <span class="fl">0.0087</span>            <span class="ot">NA</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc"</span></span></code></pre></div>
<p>Also try with these other regions:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcsk9_chrpos</span> <span class="op">&lt;-</span> <span class="st">"1:55005221-56005221"</span></span>
<span><span class="va">npc1l1_chrpos</span> <span class="op">&lt;-</span> <span class="st">"7:44052134-45052134"</span></span>
<span><span class="va">lpa_chrpos</span> <span class="op">&lt;-</span> <span class="st">"6:155952514-165952514"</span></span></code></pre></div>
<ul>
<li>PCSK9 (proprotein convertase subtilisin/kexin type 9) gene region</li>
</ul>
<p>Create dataset and harmonise trait against trait, trait against LD matrix (note that we are not saving the SummarySet objects separately, but filling them directly to the DataSet).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create S4 DataSet object (pcsk9)</span></span>
<span><span class="va">pcsk9_chrpos</span> <span class="op">&lt;-</span> <span class="st">"1:55005221-56005221"</span></span>
<span><span class="va">pcsk9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">createSummarySets</span><span class="op">(</span>traits<span class="op">=</span><span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                          variants <span class="op">=</span> <span class="st">"1:55005221-56005221"</span>,</span>
<span>                          tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"finemap"</span>,<span class="st">"coloc"</span><span class="op">)</span>,</span>
<span>                          source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>,</span>
<span>                          ld_ref <span class="op">=</span> <span class="st">"/project/data/reference/ld/EUR"</span><span class="op">)</span>                        </span>
<span> <span class="va">pcsk9</span><span class="op">@</span><span class="va">summary_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">s</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pcsk9</span> <span class="op">&lt;-</span>  <span class="va">pcsk9</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">overlapSNP</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/harmoniseData.html">harmoniseData</a></span><span class="op">(</span><span class="va">.</span>,tolerance <span class="op">=</span> <span class="fl">0.08</span>,action <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">buildLDMatrix</span><span class="op">(</span><span class="va">.</span>, bfile <span class="op">=</span> <span class="cn">TRUE</span>, plink_bin <span class="op">=</span> <span class="st">"plink"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">harmoniseLDMatrix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> </span></code></pre></div>
<p>Marginalise each summary set independently and create a new dataset with all marginalised summary sets merged</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># do finemapping with susie</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>ntraits &lt;-<span class="st"> </span><span class="kw">getLength</span>(pcsk9)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>pcsk9_marginalised &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>ntraits, <span class="cf">function</span>(trait)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>  {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>    <span class="co"># Takes in 1 SS</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>    <span class="co"># Outputs 1 DS (with at least 1 SS)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>    ds &lt;-<span class="st"> </span><span class="kw">susie_rss</span>(<span class="dt">R =</span> <span class="kw">getLDMatrix</span>(pcsk9,trait), <span class="dt">summaryset =</span> <span class="kw">getSummarySet</span>(pcsk9, trait))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>}) </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>a<span class="dv">-7</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>b<span class="dv">-109</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>b<span class="dv">-111</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ebi<span class="op">-</span>a<span class="op">-</span>GCST006867), with the parameter values used. The summary statistics beta and se will not be marginalised.</span></code></pre></div>
<p>Because not all datasets were marginalised, we are going to merge just the ones that were</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_hmgcr_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_datasets.html">merge_datasets</a></span><span class="op">(</span><span class="va">ds_hmgcr_marginalised</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Try hyprcoloc with raw datasets.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>res_pcsk9 &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span> pcsk9)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="kw">print</span>(res_pcsk9)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>  iteration traits posterior_prob regional_prob candidate_snp</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span>   None             <span class="ot">NA</span>        <span class="fl">0.1472</span>            <span class="ot">NA</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span>   None             <span class="ot">NA</span>        <span class="fl">0.0003</span>            <span class="ot">NA</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="dv">3</span>         <span class="dv">3</span>   None             <span class="ot">NA</span>        <span class="fl">0.0001</span>            <span class="ot">NA</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a><span class="dv">4</span>         <span class="dv">4</span>   None             <span class="ot">NA</span>        <span class="fl">0.0001</span>            <span class="ot">NA</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>  posterior_explained_by_snp    dropped_trait</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a><span class="dv">1</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-110</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a><span class="dv">2</span>                         <span class="ot">NA</span>          ieu<span class="op">-</span>a<span class="dv">-7</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a><span class="dv">3</span>                         <span class="ot">NA</span> ebi<span class="op">-</span>a<span class="op">-</span>GCST006867</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a><span class="dv">4</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-109</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc"</span></span></code></pre></div>
<p>Try hyprcoloc with marginalised datasets</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>res_pcsk9_marginalised &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span>pcsk9_marginalised)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="kw">print</span>(res_pcsk9_marginalised)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>  iteration traits posterior_prob regional_prob candidate_snp</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span>   None             <span class="ot">NA</span>        <span class="fl">0.6947</span>            <span class="ot">NA</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span>   None             <span class="ot">NA</span>        <span class="fl">0.4759</span>            <span class="ot">NA</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a><span class="dv">3</span>         <span class="dv">3</span>   None             <span class="ot">NA</span>        <span class="fl">0.3103</span>            <span class="ot">NA</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a><span class="dv">4</span>         <span class="dv">4</span>   None             <span class="ot">NA</span>        <span class="fl">0.0017</span>            <span class="ot">NA</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a><span class="dv">5</span>         <span class="dv">5</span>   None             <span class="ot">NA</span>        <span class="fl">0.0010</span>            <span class="ot">NA</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a><span class="dv">6</span>         <span class="dv">6</span>   None             <span class="ot">NA</span>        <span class="fl">0.0001</span>            <span class="ot">NA</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a><span class="dv">7</span>         <span class="dv">7</span>   None             <span class="ot">NA</span>        <span class="fl">0.0003</span>            <span class="ot">NA</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a><span class="dv">8</span>         <span class="dv">8</span>   None             <span class="ot">NA</span>        <span class="fl">0.0001</span>            <span class="ot">NA</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a><span class="dv">9</span>         <span class="dv">9</span>   None             <span class="ot">NA</span>        <span class="fl">0.0001</span>            <span class="ot">NA</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>  posterior_explained_by_snp dropped_trait</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true"></a><span class="dv">1</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L6</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true"></a><span class="dv">2</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L1</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true"></a><span class="dv">3</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L5</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true"></a><span class="dv">4</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L2</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true"></a><span class="dv">5</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L7</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true"></a><span class="dv">6</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L4</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true"></a><span class="dv">7</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L8</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true"></a><span class="dv">8</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L3</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true"></a><span class="dv">9</span>                         <span class="ot">NA</span>  ieu<span class="op">-</span>b<span class="dv">-110</span>_L9</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc"</span></span></code></pre></div>
<ul>
<li>NPC1L1 (NPC1 like intracellular cholesterol transporter 1) gene region Create dataset and harmonise trait against trait, trait against LD matrix</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create S4 DataSet object (npc1l1)</span></span>
<span><span class="va">npc1l1_chrpos</span> <span class="op">&lt;-</span> <span class="st">"7:44052134-45052134"</span></span>
<span><span class="va">npc1l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">createSummarySets</span><span class="op">(</span>traits<span class="op">=</span><span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                          variants <span class="op">=</span> <span class="st">"7:44052134-45052134"</span>,</span>
<span>                          tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"finemap"</span>,<span class="st">"coloc"</span><span class="op">)</span>,</span>
<span>                          source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>,</span>
<span>                          ld_ref <span class="op">=</span> <span class="st">"/project/data/reference/ld/EUR"</span><span class="op">)</span>                        </span>
<span> <span class="va">npc1l1</span><span class="op">@</span><span class="va">summary_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">s</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">npc1l1</span> <span class="op">&lt;-</span>  <span class="va">npc1l1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">overlapSNP</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/harmoniseData.html">harmoniseData</a></span><span class="op">(</span><span class="va">.</span>,tolerance <span class="op">=</span> <span class="fl">0.08</span>,action <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">buildLDMatrix</span><span class="op">(</span><span class="va">.</span>, bfile <span class="op">=</span> <span class="cn">TRUE</span>, plink_bin <span class="op">=</span> <span class="st">"plink"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">harmoniseLDMatrix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> </span></code></pre></div>
<p>Marginalise each summary set independently and create a new dataset with all marginalised summary sets merged</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>ntraits &lt;-<span class="st"> </span><span class="kw">getLength</span>( npc1l1)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>npc1l1_marginalised &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>ntraits, <span class="cf">function</span>(trait)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>  {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a>    <span class="co"># Takes in 1 SS</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>    <span class="co"># Outputs 1 DS (with at least 1 SS)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>    ds &lt;-<span class="st"> </span><span class="kw">susie_rss</span>(<span class="dt">R =</span> <span class="kw">getLDMatrix</span>(npc1l1,trait), <span class="dt">summaryset =</span> <span class="kw">getSummarySet</span>( npc1l1, trait))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>}) </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>WARNING<span class="op">:</span><span class="st"> </span>There is no credible sets <span class="cf">for</span> this <span class="kw">trait</span> (ieu<span class="op">-</span>a<span class="dv">-7</span>), with the parameter values used. The summary statistics beta and se will not be marginalised.</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a>susieR is using gwasglue2 SummarySet class object as input</span></code></pre></div>
<p>Because not all datasets were marginalised, we are going to merge just the ones that were</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">npc1l1_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_datasets.html">merge_datasets</a></span><span class="op">(</span><span class="va">npc1l1_marginalised</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">npc1l1_marginalised</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">npc1l1_marginalised</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="va">npc1l1_marginalised</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Try hyprcoloc with raw datasets.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>res_npc1l1 &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span> npc1l1)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="kw">print</span>(res_npc1l1)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>  iteration traits posterior_prob regional_prob candidate_snp</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span>   None             <span class="ot">NA</span>        <span class="fl">0.0348</span>            <span class="ot">NA</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span>   None             <span class="ot">NA</span>        <span class="fl">0.2827</span>            <span class="ot">NA</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a><span class="dv">3</span>         <span class="dv">3</span>   None             <span class="ot">NA</span>        <span class="fl">0.0370</span>            <span class="ot">NA</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a><span class="dv">4</span>         <span class="dv">4</span>   None             <span class="ot">NA</span>        <span class="fl">0.0041</span>            <span class="ot">NA</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a>  posterior_explained_by_snp    dropped_trait</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a><span class="dv">1</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-110</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a><span class="dv">2</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-111</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a><span class="dv">3</span>                         <span class="ot">NA</span> ebi<span class="op">-</span>a<span class="op">-</span>GCST006867</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a><span class="dv">4</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-109</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc</span></span></code></pre></div>
<p>Try hyprcoloc with marginalised datasets</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a>res_npc1l1_marginalised &lt;-<span class="st"> </span><span class="kw">hyprcoloc</span>(<span class="dt">dataset =</span>npc1l1_marginalised)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>hyprcoloc is using gwasglue2 DataSet class object as input</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a><span class="kw">print</span>(res_npc1l1_marginalised)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a><span class="op">$</span>results</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a>  iteration traits posterior_prob regional_prob candidate_snp</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a><span class="dv">1</span>         <span class="dv">1</span>   None             <span class="ot">NA</span>        <span class="fl">0.0402</span>            <span class="ot">NA</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a><span class="dv">2</span>         <span class="dv">2</span>   None             <span class="ot">NA</span>        <span class="fl">0.0577</span>            <span class="ot">NA</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a><span class="dv">3</span>         <span class="dv">3</span>   None             <span class="ot">NA</span>        <span class="fl">0.0082</span>            <span class="ot">NA</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a><span class="dv">4</span>         <span class="dv">4</span>   None             <span class="ot">NA</span>        <span class="fl">0.0027</span>            <span class="ot">NA</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a><span class="dv">5</span>         <span class="dv">5</span>   None             <span class="ot">NA</span>        <span class="fl">0.0012</span>            <span class="ot">NA</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a><span class="dv">6</span>         <span class="dv">6</span>   None             <span class="ot">NA</span>        <span class="fl">0.0009</span>            <span class="ot">NA</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a>  posterior_explained_by_snp       dropped_trait</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a><span class="dv">1</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-111</span>_L1</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a><span class="dv">2</span>                         <span class="ot">NA</span> ebi<span class="op">-</span>a<span class="op">-</span>GCST006867_L1</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a><span class="dv">3</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-110</span>_L2</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a><span class="dv">4</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-109</span>_L1</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a><span class="dv">5</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-111</span>_L2</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a><span class="dv">6</span>                         <span class="ot">NA</span>        ieu<span class="op">-</span>b<span class="dv">-110</span>_L1</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">"class"</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">"hyprcoloc"</span></span></code></pre></div>
<ul>
<li>LPA (Lipoprotein(A)) gene region Create dataset and harmonise trait against trait, trait against LD matrix</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create S4 DataSet object (lpa)</span></span>
<span><span class="va">lpa_chrpos</span> <span class="op">&lt;-</span> <span class="st">"6:155952514-165952514"</span></span>
<span><span class="va">lpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">createSummarySets</span><span class="op">(</span>traits<span class="op">=</span><span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                          variants <span class="op">=</span> <span class="st">"6:155952514-165952514"</span>,</span>
<span>                          tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"finemap"</span>,<span class="st">"coloc"</span><span class="op">)</span>,</span>
<span>                          source <span class="op">=</span> <span class="st">"IEUopenGWAS"</span>,</span>
<span>                          ld_ref <span class="op">=</span> <span class="st">"/project/data/reference/ld/EUR"</span><span class="op">)</span>                        </span>
<span> <span class="va">lpa</span><span class="op">@</span><span class="va">summary_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">s</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">lpa</span> <span class="op">&lt;-</span>  <span class="va">lpa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">overlapSNP</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/harmoniseData.html">harmoniseData</a></span><span class="op">(</span><span class="va">.</span>,tolerance <span class="op">=</span> <span class="fl">0.08</span>,action <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">buildLDMatrix</span><span class="op">(</span><span class="va">.</span>, bfile <span class="op">=</span> <span class="cn">TRUE</span>, plink_bin <span class="op">=</span> <span class="st">"plink"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">harmoniseLDMatrix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> </span></code></pre></div>
<p>Marginalise each summary set independently and create a new dataset with all marginalised summary sets merged</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ntraits</span> <span class="op">&lt;-</span> <span class="fu">getLength</span><span class="op">(</span><span class="va">lpa</span><span class="op">)</span></span>
<span><span class="va">npc1l1_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ntraits</span>, <span class="kw">function</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="co"># Takes in 1 SS</span></span>
<span>    <span class="co"># Outputs 1 DS (with at least 1 SS)</span></span>
<span>    <span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/susieR/man/susie_rss.html" class="external-link">susie_rss</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fu">getLDMatrix</span><span class="op">(</span><span class="va">lpa</span>,<span class="va">trait</span><span class="op">)</span>, summaryset <span class="op">=</span> <span class="fu">getSummarySet</span><span class="op">(</span><span class="va">lpa</span>, <span class="va">trait</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">lpa_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_datasets.html">merge_datasets</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Because not all datasets were marginalised, we are going to merge just the ones that were</p>
<p>Try hyprcoloc with raw datasets.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res_lpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyprcoloc/man/hyprcoloc.html" class="external-link">hyprcoloc</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">nlpa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_lpa</span><span class="op">)</span></span></code></pre></div>
<p>Try hyprcoloc with marginalised datasets</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_lpa_marginalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyprcoloc/man/hyprcoloc.html" class="external-link">hyprcoloc</a></span><span class="op">(</span>dataset <span class="op">=</span><span class="va">lpa_marginalised</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_lpa_marginalised</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gibran Hemani, Rita Rasteiro, Christopher Woods.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
