<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gwasglue2">
<title>LD score regression â€¢ gwasglue2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LD score regression">
<meta property="og:description" content="gwasglue2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gwasglue2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Strategy.html">Strategy</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-howtos">HOWTOs</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-howtos">
    <a class="dropdown-item" href="../articles/input.html">Input</a>
    <a class="dropdown-item" href="../articles/processing.html">Processing</a>
    <a class="dropdown-item" href="../articles/output.html">Output</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/mr.html">MR analysis</a>
    <a class="dropdown-item" href="../articles/finemap_coloc1.html">Regional genotype-phenotype map</a>
    <a class="dropdown-item" href="../articles/ldsc.html">LD score regression</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-yaml">YAML</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-yaml">
    <a class="dropdown-item" href="../articles/yaml_tutorials.html">YAML tutorials</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MRCIEU/gwasglue2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="ldsc_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>LD score regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MRCIEU/gwasglue2/blob/HEAD/vignettes/ldsc.Rmd" class="external-link"><code>vignettes/ldsc.Rmd</code></a></small>
      <div class="d-none name"><code>ldsc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mrcieu/ieugwasr"</span>,ref<span class="op">=</span><span class="fu"><a href="https://remotes.r-lib.org/reference/github_refs.html" class="external-link">github_pull</a></span><span class="op">(</span><span class="st">"48"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/ieugwasr" class="external-link">ieugwasr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/gwasglue2" class="external-link">gwasglue2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GenomicSEM</span><span class="op">)</span> <span class="co"># https://github.com/GenomicSEM/GenomicSEM</span></span></code></pre></div>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<div class="section level4">
<h4 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h4>
<p>Perform genetic correlation estimation using the <a href="https://www.nature.com/articles/ng.3406" class="external-link">LD Score regression method</a>. In this example we will estimate the genetic correlation between body mass index and coronary heart disease.</p>
</div>
<div class="section level4">
<h4 id="file-formats">File formats<a class="anchor" aria-label="anchor" href="#file-formats"></a>
</h4>
<p>We will use the GenomicSEM R package to perform LDSC. It can also perform numerous other analytical methods that are based on the same file formatting system. The file format is slightly different to other analyses in R, it is based on text files that are formatted in a particular way as described by the original LDSC software (<a href="https://github.com/bulik/ldsc" class="external-link uri">https://github.com/bulik/ldsc</a>). It needs</p>
<p><strong>GWAS summary data format:</strong></p>
<pre><code>SNP     A1      A2      N       CHISQ   Z
rs4075116       T       C       118122.0        4.04509062862   2.01124106676
rs3766192       T       C       120302.0        1.19661141803   1.0938973526
rs9442372       G       A       120277.0        1.18175008915   1.08708329449
rs3737728       G       A       120288.0        2.05206404517   1.43250272082
rs9442398       G       A       120303.0        2.43043331408   1.55898470617</code></pre>
<p><strong>LD score files:</strong></p>
<p>A directory like this:</p>
<pre><code>/path/to/ldscores/
  1.l2.ldscore.gz
  2.l2.ldscore.gz
  3.l2.ldscore.gz
  ...
  22.l2.ldscore.gz</code></pre>
<p>and <code>1.l2.ldscore.gz</code> looks like:</p>
<pre><code>CHR     SNP     BP      L2
1       rs3094315       752566  80.826
1       rs3131972       752721  80.939
1       rs3131969       754182  90.291
1       rs1048488       760912  80.679
1       rs3115850       761147  80.483</code></pre>
<p>The SNPs used can be restricted to HapMap3 SNPs, and LD scores for HapMap3 variants can be obtained from OpenGWAS using</p>
<p>Currently GenomicSEM requires that the data is provided as flat files so to go from OpenGWAS to GenomicSEM</p>
<ol style="list-style-type: decimal">
<li>Query the data from OpenGWAS</li>
<li>Format and save as flat files</li>
<li>Provide the flat files to <code><a href="https://rdrr.io/pkg/GenomicSEM/man/ldsc.html" class="external-link">GenomicSEM::ldsc()</a></code>
</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download hapmap3 variants</span></span>
<span><span class="va">ldscores</span> <span class="op">&lt;-</span> <span class="fu">ieugwasr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ieugwasr/man/afl2_list.html" class="external-link">afl2_list</a></span><span class="op">(</span><span class="st">"hapmap3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write LD scores split by and save directory name. Convert variant IDs to gwasglue2 system</span></span>
<span></span>
<span><span class="fu">ieugwasr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ieugwasr/man/write_ldscores.html" class="external-link">write_ldscores</a></span><span class="op">(</span><span class="va">ldscores</span>, <span class="st">"EUR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="classic-pipeline">Classic pipeline<a class="anchor" aria-label="anchor" href="#classic-pipeline"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Obtain summary data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>  id_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ieu-a-2"</span>, <span class="st">"ieu-a-7"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>  dataset &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">seq_along</span>(id_list), <span class="cf">function</span>(i){</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>    <span class="co"># create summarysets</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>    dt &lt;-<span class="st"> </span>ieugwasr<span class="op">::</span><span class="kw">associations</span>(<span class="dt">variants =</span> ldscores<span class="op">$</span>rsid, <span class="dt">id=</span> id_list[i], <span class="dt">gwasglue =</span> <span class="ot">TRUE</span>) </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>  })  <span class="op">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="st">    </span><span class="co"># create dataset and harmonise trait againts trait</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">create_dataset</span>(., <span class="dt">harmonise =</span> <span class="ot">TRUE</span>, <span class="dt">tolerance =</span> <span class="fl">0.08</span>, <span class="dt">action =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="st">    </span><span class="co"># set zscores and chisq</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">setZscores</span>() <span class="op">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">setChisq</span>()</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>  <span class="co"># Write summary data to files in LDSC format, and save the array of path names</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>  trait_paths &lt;-<span class="st"> </span>gwasglue2<span class="op">::</span><span class="kw">write_ldsc</span>(dataset)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>  ldscore_path &lt;-<span class="st"> "ldsc/EUR"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>  <span class="co"># Perform analysis</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>  res &lt;-<span class="st"> </span>(GenomicSEM<span class="op">::</span><span class="kw">ldsc</span>(</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>  <span class="dt">traits =</span> trait_paths,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a>  <span class="dt">ld =</span> ldscore_path,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>  <span class="dt">sample.prev =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="fl">0.5</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a>  <span class="dt">population.prev =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a>res</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rita Rasteiro, Gibran Hemani, Christopher Woods.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
